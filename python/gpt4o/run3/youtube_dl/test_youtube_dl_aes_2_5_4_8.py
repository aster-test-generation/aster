import unittest
from youtube_dl.aes import aes_cbc_decrypt


class TestAESFunctions(unittest.TestCase):
    def test_mix_columns(self):
        data = [0x87, 0x6E, 0x46, 0xA6, 0xF2, 0x4C, 0xE7, 0x8C, 0x4D, 0x90, 0x4A, 0xD8, 0x97, 0xEC, 0xC3, 0x95]
        expected = [0x47, 0x37, 0x94, 0xED, 0x40, 0xD4, 0xE4, 0xA5, 0xA3, 0x70, 0x3A, 0xA6, 0x4C, 0x9F, 0x42, 0xBC]
        result = mix_columns(data)
        self.assertEqual(result, expected)

    def test_mix_column(self):
        column = [0x87, 0x6E, 0x46, 0xA6]
        expected = [0x47, 0x37, 0x94, 0xED]
        result = _mix_column(column, MIX_COLUMN_MATRIX)
        self.assertEqual(result, expected)

if __name__ == '__main__':
    unittest.main()